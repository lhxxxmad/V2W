from __future__ import absolute_import
from __future__ import division
from __future__ import unicode_literals
from __future__ import print_function

import json
import tempfile
import pandas as pd
from os.path import join, splitext, exists
from collections import OrderedDict
from .dataloader_retrieval import RetrievalDataset
import os


class LsmdcDataset(RetrievalDataset):
    """LSMDC dataset."""

    def __init__(self, subset, anno_path, video_path, tokenizer, max_words=32,
                 max_frames=12, video_framerate=1, image_resolution=224, mode='all', config=None):
        super(LsmdcDataset, self).__init__(subset, anno_path, video_path, tokenizer, max_words,
                                            max_frames, video_framerate, image_resolution, mode, config=config)
        pass

    def _get_anns(self, subset='train'):
        """
        video_dict: dict: video_id -> video_path
        sentences_dict: list: [(video_id, caption)] , caption (list: [text:, start, end])
        """
        video_json_path_dict = {}
        video_json_path_dict["train"] = os.path.join(self.anno_path, "LSMDC16_annos_training.csv")
        video_json_path_dict["val"] = os.path.join(self.anno_path, "LSMDC16_annos_val.csv")
        video_json_path_dict["test"] = os.path.join(self.anno_path, "LSMDC16_challenge_1000_publictect.csv")

        # <CLIP_ID>\t<START_ALIGNED>\t<END_ALIGNED>\t<START_EXTRACTED>\t<END_EXTRACTED>\t<SENTENCE>
        # <CLIP_ID> is not a unique identifier, i.e. the same <CLIP_ID> can be associated with multiple sentences.
        # However, LSMDC16_challenge_1000_publictect.csv has no repeat instances
        video_id_list = []
        caption_dict = {}
        with open(video_json_path_dict[self.subset], 'r') as fp:
            for line in fp:
                line = line.strip()
                line_split = line.split("\t")
                assert len(line_split) == 6
                clip_id, start_aligned, end_aligned, start_extracted, end_extracted, sentence = line_split
                if clip_id not in ['0005_Chinatown_00.20.16.317-00.20.18.261', '3014_CAPTAIN_AMERICA_01.33.14.159-01.33.20.160', '3063_SOUL_SURFER_01.09.13.000-01.09.18.428', '3087_WE_BOUGHT_A_ZOO_00.12.52.366-00.12.54.397', '3022_DINNER_FOR_SCHMUCKS_00.36.47.355-00.36.52.711', '3063_SOUL_SURFER_01.34.06.526-01.34.10.101', '3044_KNOCKED_UP_01.43.05.811-01.43.08.869', '0005_Chinatown_02.01.27.288-02.01.28.740', '3023_DISTRICT_9_00.10.28.991-00.10.35.169', '3063_SOUL_SURFER_00.29.04.000-00.29.13.102', '3063_SOUL_SURFER_01.13.44.273-01.13.55.621', '3023_DISTRICT_9_00.03.31.000-00.03.35.050', '3044_KNOCKED_UP_00.11.52.000-00.11.55.098', '3091_ZOMBIELAND_00.58.01.722-00.58.02.856', '3091_ZOMBIELAND_00.33.29.112-00.33.30.194', '3022_DINNER_FOR_SCHMUCKS_01.42.55.904-01.43.00.451', '3023_DISTRICT_9_01.12.18.126-01.12.22.800', '3044_KNOCKED_UP_00.14.15.000-00.14.17.734', '3023_DISTRICT_9_00.30.56.344-00.30.57.655', '0005_Chinatown_00.31.04.942-00.31.11.997', '3044_KNOCKED_UP_01.57.46.095-01.57.47.024', '3014_CAPTAIN_AMERICA_00.39.40.268-00.39.50.192', '3087_WE_BOUGHT_A_ZOO_01.57.58.888-01.58.03.091', '3014_CAPTAIN_AMERICA_01.07.08.465-01.07.09.852', '3091_ZOMBIELAND_00.57.02.616-00.57.04.348', '3087_WE_BOUGHT_A_ZOO_00.52.14.995-00.52.17.273', '3091_ZOMBIELAND_00.08.34.967-00.08.37.044', '3023_DISTRICT_9_00.45.52.396-00.45.58.236', '0005_Chinatown_00.45.44.080-00.45.51.864', '3044_KNOCKED_UP_01.09.33.285-01.09.43.785', '3063_SOUL_SURFER_01.08.52.587-01.08.56.438', '3023_DISTRICT_9_01.03.00.224-01.03.02.883', '3091_ZOMBIELAND_01.03.34.472-01.03.35.044', '3044_KNOCKED_UP_01.12.52.000-01.12.55.573', '3019_COLOMBIANA_01.17.04.269-01.17.06.420', '3044_KNOCKED_UP_00.32.52.912-00.32.55.592', '0005_Chinatown_00.50.43.344-00.50.50.165', '3091_ZOMBIELAND_01.07.02.517-01.07.03.017', '3023_DISTRICT_9_01.23.08.713-01.23.16.349', '3087_WE_BOUGHT_A_ZOO_01.24.30.166-01.24.36.530', '3044_KNOCKED_UP_01.51.17.837-01.51.21.458', '3023_DISTRICT_9_00.55.52.892-00.55.59.976', '3014_CAPTAIN_AMERICA_00.08.22.236-00.08.27.564', '3044_KNOCKED_UP_01.35.37.000-01.35.40.537', '3023_DISTRICT_9_01.40.33.945-01.40.37.178', '3022_DINNER_FOR_SCHMUCKS_00.47.15.873-00.47.21.785', '3087_WE_BOUGHT_A_ZOO_01.46.18.819-01.46.24.256', '3044_KNOCKED_UP_00.23.21.574-00.23.26.386', '3087_WE_BOUGHT_A_ZOO_01.07.11.861-01.07.15.270', '3014_CAPTAIN_AMERICA_01.03.36.765-01.03.41.148', '3063_SOUL_SURFER_01.09.03.699-01.09.07.320', '3023_DISTRICT_9_00.36.01.000-00.36.06.050', '3014_CAPTAIN_AMERICA_01.25.13.509-01.25.22.573', '3014_CAPTAIN_AMERICA_01.32.37.895-01.32.40.383', '3063_SOUL_SURFER_00.27.13.906-00.27.16.634', '3019_COLOMBIANA_00.31.07.000-00.31.13.341', '3091_ZOMBIELAND_00.03.13.071-00.03.17.686', '3014_CAPTAIN_AMERICA_00.36.25.903-00.36.31.539', '0017_Pianist_00.30.36.767-00.30.38.009', '3014_CAPTAIN_AMERICA_01.33.02.693-01.33.07.333', '3014_CAPTAIN_AMERICA_01.05.01.018-01.05.03.451', '3063_SOUL_SURFER_00.39.54.400-00.40.04.783', '3063_SOUL_SURFER_01.08.36.954-01.08.38.651', '3022_DINNER_FOR_SCHMUCKS_00.39.32.441-00.39.34.618', '3063_SOUL_SURFER_01.14.21.000-01.14.25.904', '3091_ZOMBIELAND_00.46.14.872-00.46.19.293', '0005_Chinatown_01.37.14.146-01.37.19.126', '0005_Chinatown_01.20.16.527-01.20.20.866', '3014_CAPTAIN_AMERICA_01.49.07.985-01.49.14.819', '0005_Chinatown_00.44.21.833-00.44.23.282', '3014_CAPTAIN_AMERICA_00.14.45.421-00.14.51.304', '0005_Chinatown_00.27.05.791-00.27.08.931', '3044_KNOCKED_UP_01.12.16.000-01.12.20.050', '3091_ZOMBIELAND_01.07.13.173-01.07.16.729', '3023_DISTRICT_9_00.48.26.390-00.48.30.081', '3063_SOUL_SURFER_01.10.53.341-01.10.54.890', '3023_DISTRICT_9_01.37.52.132-01.37.53.985', '3022_DINNER_FOR_SCHMUCKS_00.46.51.371-00.46.53.316', '0005_Chinatown_00.30.52.710-00.30.54.401', '3022_DINNER_FOR_SCHMUCKS_00.43.11.233-00.43.12.956', '3091_ZOMBIELAND_00.25.54.670-00.25.56.710', '3022_DINNER_FOR_SCHMUCKS_00.26.46.498-00.26.48.693', '3014_CAPTAIN_AMERICA_01.18.27.114-01.18.30.170', '3014_CAPTAIN_AMERICA_00.04.13.946-00.04.16.475', '3023_DISTRICT_9_01.44.44.182-01.44.49.797', '3014_CAPTAIN_AMERICA_01.19.01.272-01.19.03.118', '3023_DISTRICT_9_00.31.33.309-00.31.36.020', '3087_WE_BOUGHT_A_ZOO_00.29.48.872-00.29.49.759', '0005_Chinatown_01.50.29.472-01.50.30.925', '3063_SOUL_SURFER_00.47.01.456-00.47.07.539', '0005_Chinatown_00.51.06.793-00.51.09.700', '3091_ZOMBIELAND_00.11.43.248-00.11.48.183', '3022_DINNER_FOR_SCHMUCKS_01.33.57.516-01.34.00.056', '3087_WE_BOUGHT_A_ZOO_01.16.29.736-01.16.32.432', '0005_Chinatown_00.52.25.759-00.52.31.857', '3022_DINNER_FOR_SCHMUCKS_01.38.52.321-01.38.55.158', '3022_DINNER_FOR_SCHMUCKS_01.35.15.164-01.35.15.958', '0005_Chinatown_00.09.23.841-00.09.35.702', '3014_CAPTAIN_AMERICA_00.31.53.645-00.31.59.889', '3087_WE_BOUGHT_A_ZOO_00.42.49.747-00.42.57.365', '3022_DINNER_FOR_SCHMUCKS_01.17.23.369-01.17.25.844', '3063_SOUL_SURFER_01.20.54.958-01.20.57.514', '0005_Chinatown_00.34.45.826-00.34.47.663', '3022_DINNER_FOR_SCHMUCKS_00.36.30.906-00.36.33.468', '3014_CAPTAIN_AMERICA_00.41.44.074-00.41.44.647', '3023_DISTRICT_9_01.27.23.205-01.27.28.164', '3063_SOUL_SURFER_00.28.57.272-00.29.03.938', '0005_Chinatown_00.28.06.665-00.28.08.109', '3022_DINNER_FOR_SCHMUCKS_01.29.17.455-01.29.23.226', '3023_DISTRICT_9_00.36.17.646-00.36.26.065', '3087_WE_BOUGHT_A_ZOO_01.37.49.865-01.37.52.209', '0005_Chinatown_01.40.35.606-01.40.41.240', '3014_CAPTAIN_AMERICA_00.09.03.915-00.09.06.096', '3023_DISTRICT_9_00.35.37.252-00.35.39.931', '0005_Chinatown_01.35.43.128-01.35.44.104', '3087_WE_BOUGHT_A_ZOO_00.36.01.995-00.36.04.752', '0005_Chinatown_01.40.41.240-01.40.44.549', '3087_WE_BOUGHT_A_ZOO_00.10.07.414-00.10.12.605', '3014_CAPTAIN_AMERICA_01.41.45.367-01.41.53.432', '3022_DINNER_FOR_SCHMUCKS_00.37.56.417-00.37.57.417', '3023_DISTRICT_9_01.22.31.281-01.22.32.171', '3022_DINNER_FOR_SCHMUCKS_01.19.04.768-01.19.07.590', '3091_ZOMBIELAND_00.43.37.055-00.43.38.417', '0005_Chinatown_00.40.11.991-00.40.15.131', '3091_ZOMBIELAND_00.51.24.807-00.51.27.524', '3087_WE_BOUGHT_A_ZOO_01.34.47.216-01.34.49.374', '3014_CAPTAIN_AMERICA_00.22.56.551-00.22.59.543', '3091_ZOMBIELAND_01.17.12.047-01.17.14.815', '0005_Chinatown_00.40.12.309-00.40.15.315', '3023_DISTRICT_9_01.00.48.000-01.00.53.828', '3023_DISTRICT_9_01.36.48.000-01.36.52.278', '3022_DINNER_FOR_SCHMUCKS_01.13.45.803-01.13.50.797', '3087_WE_BOUGHT_A_ZOO_00.40.09.756-00.40.13.122', '3063_SOUL_SURFER_00.33.37.408-00.33.38.559', '3014_CAPTAIN_AMERICA_01.41.53.432-01.42.05.082', '3063_SOUL_SURFER_00.46.51.000-00.46.54.884', '3091_ZOMBIELAND_00.40.55.398-00.40.57.642', '3014_CAPTAIN_AMERICA_00.04.21.391-00.04.26.290', '3014_CAPTAIN_AMERICA_00.06.51.376-00.06.59.724', '3023_DISTRICT_9_00.43.02.599-00.43.10.133', '3022_DINNER_FOR_SCHMUCKS_00.46.34.399-00.46.36.285', '3023_DISTRICT_9_01.24.08.000-01.24.17.382', '3087_WE_BOUGHT_A_ZOO_01.03.02.362-01.03.02.870', '0005_Chinatown_01.26.39.654-01.26.41.844', '3022_DINNER_FOR_SCHMUCKS_00.05.18.953-00.05.21.753', '3044_KNOCKED_UP_01.37.23.173-01.37.24.647', '3087_WE_BOUGHT_A_ZOO_00.12.52.366-00.12.54.225', '3087_WE_BOUGHT_A_ZOO_00.45.00.288-00.45.02.799', '3044_KNOCKED_UP_01.34.44.068-01.34.48.812', '3063_SOUL_SURFER_01.15.36.000-01.15.42.046', '3044_KNOCKED_UP_00.17.51.402-00.17.52.852', '3014_CAPTAIN_AMERICA_01.21.02.890-01.21.07.258', '3063_SOUL_SURFER_00.23.41.210-00.23.44.142', '3063_SOUL_SURFER_00.54.02.986-00.54.03.750', '3063_SOUL_SURFER_00.33.49.000-00.33.52.836', '3087_WE_BOUGHT_A_ZOO_00.20.01.575-00.20.06.223', '3087_WE_BOUGHT_A_ZOO_01.10.46.850-01.10.49.026', '3044_KNOCKED_UP_01.10.11.000-01.10.14.278', '3023_DISTRICT_9_00.30.08.361-00.30.11.626', '3063_SOUL_SURFER_00.40.56.754-00.40.58.784', '3023_DISTRICT_9_01.29.59.261-01.30.13.427', '3087_WE_BOUGHT_A_ZOO_01.26.50.816-01.26.54.701', '3091_ZOMBIELAND_00.17.42.612-00.17.44.261', '3063_SOUL_SURFER_01.18.33.946-01.18.36.628', '0005_Chinatown_00.50.50.165-00.50.50.921', '3091_ZOMBIELAND_01.18.13.083-01.18.13.942', '3023_DISTRICT_9_01.29.22.611-01.29.24.712', '3022_DINNER_FOR_SCHMUCKS_01.48.46.658-01.48.48.960', '3044_KNOCKED_UP_01.59.39.941-01.59.41.974', '0005_Chinatown_01.19.33.802-01.19.40.958', '0005_Chinatown_00.12.00.988-00.12.03.838', '3044_KNOCKED_UP_00.16.47.176-00.16.49.848', '3014_CAPTAIN_AMERICA_00.10.33.164-00.10.38.675', '3044_KNOCKED_UP_00.45.30.047-00.45.34.120', '3091_ZOMBIELAND_00.27.14.475-00.27.19.532', '3023_DISTRICT_9_00.42.01.595-00.42.03.401', '3091_ZOMBIELAND_01.15.25.905-01.15.32.422', '3063_SOUL_SURFER_00.14.07.306-00.14.10.827', '3063_SOUL_SURFER_01.29.33.500-01.29.37.819', '3023_DISTRICT_9_01.38.06.000-01.38.14.389', '3063_SOUL_SURFER_01.07.04.376-01.07.08.448', '0017_Pianist_00.23.28.872-00.23.34.843', '3023_DISTRICT_9_00.21.22.301-00.21.25.505', '3022_DINNER_FOR_SCHMUCKS_00.37.01.245-00.37.03.684', '3014_CAPTAIN_AMERICA_01.06.12.295-01.06.13.373', '3044_KNOCKED_UP_00.33.19.827-00.33.21.142', '3087_WE_BOUGHT_A_ZOO_00.55.55.444-00.55.57.690', '3023_DISTRICT_9_00.18.10.099-00.18.14.545', '3022_DINNER_FOR_SCHMUCKS_01.43.08.397-01.43.12.647', '3063_SOUL_SURFER_00.46.00.000-00.46.05.186', '3091_ZOMBIELAND_00.25.41.360-00.25.45.452', '3044_KNOCKED_UP_00.23.13.000-00.23.17.024', '3044_KNOCKED_UP_00.26.13.366-00.26.14.536', '3087_WE_BOUGHT_A_ZOO_00.35.00.591-00.35.03.363', '3023_DISTRICT_9_01.31.03.636-01.31.05.886', '3044_KNOCKED_UP_00.23.55.000-00.24.02.036', '3023_DISTRICT_9_01.12.55.173-01.12.58.487', '3044_KNOCKED_UP_01.16.23.048-01.16.24.835', '3063_SOUL_SURFER_01.33.48.664-01.33.54.351', '3044_KNOCKED_UP_01.29.50.000-01.29.54.385', '3044_KNOCKED_UP_00.23.27.000-00.23.32.584', '3044_KNOCKED_UP_00.55.29.988-00.55.32.206', '3023_DISTRICT_9_00.38.16.674-00.38.25.933', '3022_DINNER_FOR_SCHMUCKS_00.36.26.393-00.36.29.649', '0005_Chinatown_00.26.00.253-00.26.02.824', '0005_Chinatown_01.26.30.673-01.26.39.654', '3022_DINNER_FOR_SCHMUCKS_01.47.51.751-01.48.02.793', '3087_WE_BOUGHT_A_ZOO_00.14.13.658-00.14.16.051', '3091_ZOMBIELAND_01.18.16.156-01.18.17.964', '3022_DINNER_FOR_SCHMUCKS_00.56.46.235-00.56.48.585', '3063_SOUL_SURFER_01.10.35.000-01.10.37.739', '3022_DINNER_FOR_SCHMUCKS_01.32.36.035-01.32.37.593', '0005_Chinatown_01.35.45.606-01.35.48.060', '3022_DINNER_FOR_SCHMUCKS_00.31.29.487-00.31.33.793', '0005_Chinatown_00.03.49.298-00.03.50.927', '3023_DISTRICT_9_00.51.22.000-00.51.28.031', '3091_ZOMBIELAND_01.19.18.340-01.19.22.808', '3063_SOUL_SURFER_00.55.29.454-00.55.31.087', '3014_CAPTAIN_AMERICA_01.15.49.846-01.15.55.413', '3023_DISTRICT_9_00.22.08.055-00.22.12.399', '0005_Chinatown_00.07.06.524-00.07.09.910', '3023_DISTRICT_9_00.25.04.333-00.25.05.533', '0016_O_Brother_Where_Art_Thou_01.32.45.512-01.32.48.914', '3063_SOUL_SURFER_01.33.31.000-01.33.38.495', '3023_DISTRICT_9_00.14.32.000-00.14.40.050', '3091_ZOMBIELAND_01.01.12.583-01.01.16.576', '3091_ZOMBIELAND_00.49.00.254-00.49.04.349', '0005_Chinatown_00.57.06.845-00.57.07.971', '3014_CAPTAIN_AMERICA_00.07.14.103-00.07.22.630', '3044_KNOCKED_UP_01.37.52.969-01.37.57.764', '3063_SOUL_SURFER_00.50.03.051-00.50.06.385', '0005_Chinatown_00.31.52.624-00.31.57.591', '3044_KNOCKED_UP_00.45.23.549-00.45.30.047', '3044_KNOCKED_UP_00.40.24.910-00.40.29.897', '3023_DISTRICT_9_00.45.43.500-00.45.46.135', '3091_ZOMBIELAND_00.08.38.453-00.08.39.216', '3022_DINNER_FOR_SCHMUCKS_01.19.17.298-01.19.20.602', '3091_ZOMBIELAND_00.22.21.721-00.22.29.319', '3022_DINNER_FOR_SCHMUCKS_01.27.33.103-01.27.38.086', '3044_KNOCKED_UP_00.43.55.074-00.43.58.231', '3014_CAPTAIN_AMERICA_00.44.04.647-00.44.13.340', '3063_SOUL_SURFER_01.27.38.200-01.27.43.061', '3087_WE_BOUGHT_A_ZOO_00.44.44.553-00.44.46.207', '3087_WE_BOUGHT_A_ZOO_01.26.43.303-01.26.47.728', '3087_WE_BOUGHT_A_ZOO_01.37.52.209-01.37.55.409', '3091_ZOMBIELAND_00.14.24.654-00.14.28.975', '3022_DINNER_FOR_SCHMUCKS_01.07.08.469-01.07.16.401', '0005_Chinatown_01.58.26.980-01.58.29.175', '3091_ZOMBIELAND_00.33.46.971-00.33.48.238', '3044_KNOCKED_UP_00.09.21.980-00.09.27.102', '3023_DISTRICT_9_00.42.57.324-00.43.01.408', '3044_KNOCKED_UP_01.49.53.742-01.49.58.154', '3091_ZOMBIELAND_00.09.17.539-00.09.25.500', '3022_DINNER_FOR_SCHMUCKS_00.14.20.046-00.14.23.325', '0005_Chinatown_01.17.46.216-01.17.50.120', '3014_CAPTAIN_AMERICA_01.12.22.738-01.12.25.682', '3063_SOUL_SURFER_01.22.27.744-01.22.30.020', '3087_WE_BOUGHT_A_ZOO_01.02.10.769-01.02.12.679', '3044_KNOCKED_UP_00.40.36.289-00.40.39.021', '3023_DISTRICT_9_00.21.32.000-00.21.37.050', '3087_WE_BOUGHT_A_ZOO_00.38.49.663-00.38.52.059', '0005_Chinatown_00.34.46.265-00.34.47.238', '3014_CAPTAIN_AMERICA_01.17.05.888-01.17.08.500', '0005_Chinatown_00.54.46.856-00.54.48.309', '3022_DINNER_FOR_SCHMUCKS_00.29.01.255-00.29.03.642', '3019_COLOMBIANA_00.11.01.000-00.11.05.050', '3014_CAPTAIN_AMERICA_01.30.16.804-01.30.29.295', '3022_DINNER_FOR_SCHMUCKS_00.56.28.056-00.56.29.337', '3063_SOUL_SURFER_00.28.49.457-00.28.56.098', '3023_DISTRICT_9_00.29.11.539-00.29.14.050', '3087_WE_BOUGHT_A_ZOO_01.32.53.190-01.32.56.784', '3087_WE_BOUGHT_A_ZOO_01.57.40.280-01.57.45.622', '3091_ZOMBIELAND_00.10.34.198-00.10.46.278', '3063_SOUL_SURFER_01.11.15.157-01.11.18.396', '3044_KNOCKED_UP_00.58.57.832-00.58.59.653', '3022_DINNER_FOR_SCHMUCKS_00.05.59.829-00.06.01.247', '3087_WE_BOUGHT_A_ZOO_01.00.15.111-01.00.19.279', '3063_SOUL_SURFER_00.35.45.099-00.35.47.853', '3091_ZOMBIELAND_00.58.03.256-00.58.06.042', '3014_CAPTAIN_AMERICA_01.42.20.706-01.42.24.025', '3087_WE_BOUGHT_A_ZOO_01.37.34.502-01.37.39.361', '3044_KNOCKED_UP_00.45.19.000-00.45.23.549', '3087_WE_BOUGHT_A_ZOO_00.52.23.134-00.52.26.256', '3091_ZOMBIELAND_00.16.47.508-00.16.48.858', '0016_O_Brother_Where_Art_Thou_01.31.44.525-01.31.46.290', '3014_CAPTAIN_AMERICA_01.48.49.037-01.48.52.444', '3087_WE_BOUGHT_A_ZOO_00.40.26.903-00.40.28.550', '3022_DINNER_FOR_SCHMUCKS_00.37.12.677-00.37.16.755', '3087_WE_BOUGHT_A_ZOO_01.34.07.974-01.34.15.748', '3014_CAPTAIN_AMERICA_01.00.25.364-01.00.39.034', '3091_ZOMBIELAND_00.24.12.453-00.24.16.852', '0005_Chinatown_00.19.13.152-00.19.13.565', '3087_WE_BOUGHT_A_ZOO_01.39.20.590-01.39.25.531', '3091_ZOMBIELAND_00.08.39.316-00.08.40.947', '3087_WE_BOUGHT_A_ZOO_01.29.09.299-01.29.15.077', '3091_ZOMBIELAND_00.58.51.326-00.58.52.966', '3044_KNOCKED_UP_01.56.27.544-01.56.30.704', '3023_DISTRICT_9_01.23.05.000-01.23.08.713', '3091_ZOMBIELAND_00.14.04.415-00.14.06.319', '3014_CAPTAIN_AMERICA_01.42.37.905-01.42.46.524', '3063_SOUL_SURFER_01.11.53.000-01.12.00.442', '0005_Chinatown_00.08.53.816-00.08.55.181', '3091_ZOMBIELAND_00.56.59.947-00.57.02.516', '3087_WE_BOUGHT_A_ZOO_01.35.22.202-01.35.28.580', '3087_WE_BOUGHT_A_ZOO_00.48.04.057-00.48.10.090', '3022_DINNER_FOR_SCHMUCKS_01.46.25.899-01.46.28.545', '3022_DINNER_FOR_SCHMUCKS_01.03.02.882-01.03.05.192', '3091_ZOMBIELAND_00.55.14.352-00.55.15.458', '3022_DINNER_FOR_SCHMUCKS_01.48.49.060-01.48.53.360', '0005_Chinatown_00.31.36.204-00.31.37.550', '3022_DINNER_FOR_SCHMUCKS_01.05.57.891-01.06.09.170', '3091_ZOMBIELAND_00.14.06.419-00.14.15.874', '3023_DISTRICT_9_00.27.41.290-00.27.46.653', '3087_WE_BOUGHT_A_ZOO_00.56.05.478-00.56.11.635', '0005_Chinatown_00.09.03.825-00.09.06.155', '3019_COLOMBIANA_00.14.19.161-00.14.27.622', '3063_SOUL_SURFER_00.54.41.952-00.54.49.011', '3023_DISTRICT_9_00.30.59.746-00.31.04.949', '3091_ZOMBIELAND_00.09.46.730-00.09.48.919', '3044_KNOCKED_UP_01.51.57.442-01.52.01.335', '3044_KNOCKED_UP_00.46.03.054-00.46.07.893', '3023_DISTRICT_9_00.13.44.900-00.13.48.977', '3044_KNOCKED_UP_00.40.07.666-00.40.12.604', '3087_WE_BOUGHT_A_ZOO_00.26.01.374-00.26.08.464', '3014_CAPTAIN_AMERICA_00.57.25.072-00.57.32.112', '3044_KNOCKED_UP_01.58.14.000-01.58.19.704', '3022_DINNER_FOR_SCHMUCKS_01.49.07.605-01.49.11.899', '3087_WE_BOUGHT_A_ZOO_01.28.42.797-01.28.46.364', '3063_SOUL_SURFER_01.35.11.000-01.35.17.007', '3063_SOUL_SURFER_01.25.29.000-01.25.36.240', '3022_DINNER_FOR_SCHMUCKS_01.41.45.856-01.41.46.819', '3044_KNOCKED_UP_00.37.57.509-00.38.00.231', '3063_SOUL_SURFER_00.47.09.207-00.47.18.073', '3091_ZOMBIELAND_00.43.44.880-00.43.47.046', '0005_Chinatown_00.49.06.134-00.49.06.645', '3022_DINNER_FOR_SCHMUCKS_01.35.12.430-01.35.12.893', '3014_CAPTAIN_AMERICA_01.37.00.964-01.37.03.868', '3091_ZOMBIELAND_01.17.31.269-01.17.36.668', '3014_CAPTAIN_AMERICA_01.23.20.028-01.23.25.498', '3087_WE_BOUGHT_A_ZOO_01.50.31.419-01.50.36.321', '3014_CAPTAIN_AMERICA_01.39.49.978-01.39.59.344', '3091_ZOMBIELAND_00.49.43.853-00.49.47.605', '3014_CAPTAIN_AMERICA_00.39.51.065-00.39.53.787', '3023_DISTRICT_9_00.50.22.928-00.50.24.228', '3023_DISTRICT_9_01.12.44.778-01.12.48.729', '3044_KNOCKED_UP_01.34.17.000-01.34.23.818', '3087_WE_BOUGHT_A_ZOO_01.40.47.139-01.40.49.228', '3022_DINNER_FOR_SCHMUCKS_00.39.45.718-00.39.46.337', '3014_CAPTAIN_AMERICA_01.37.44.267-01.37.47.689', '0005_Chinatown_01.29.25.351-01.29.29.792', '0005_Chinatown_01.35.48.060-01.36.01.466', '3022_DINNER_FOR_SCHMUCKS_00.58.32.307-00.58.37.730', '3044_KNOCKED_UP_00.40.34.218-00.40.36.289', '0005_Chinatown_00.12.28.340-00.12.55.680', '3022_DINNER_FOR_SCHMUCKS_01.48.35.026-01.48.39.009', '3014_CAPTAIN_AMERICA_00.56.09.805-00.56.11.348', '3091_ZOMBIELAND_00.16.58.754-00.16.59.920', '3087_WE_BOUGHT_A_ZOO_00.03.37.809-00.03.38.951', '3023_DISTRICT_9_01.39.47.000-01.39.52.050', '3044_KNOCKED_UP_00.55.16.342-00.55.20.114', '3063_SOUL_SURFER_01.35.03.000-01.35.04.840', '3014_CAPTAIN_AMERICA_00.48.02.837-00.48.08.282', '3014_CAPTAIN_AMERICA_00.42.31.043-00.42.33.094', '3014_CAPTAIN_AMERICA_00.31.17.161-00.31.24.491', '0005_Chinatown_00.43.42.930-00.43.43.644', '3063_SOUL_SURFER_00.36.26.596-00.36.38.748', '3022_DINNER_FOR_SCHMUCKS_01.21.57.225-01.22.01.401', '3014_CAPTAIN_AMERICA_00.19.47.141-00.19.50.665', '3023_DISTRICT_9_01.07.44.000-01.07.50.050', '3022_DINNER_FOR_SCHMUCKS_00.59.47.149-00.59.48.493', '3087_WE_BOUGHT_A_ZOO_00.12.00.731-00.12.02.979', '3091_ZOMBIELAND_00.06.32.978-00.06.35.408', '3087_WE_BOUGHT_A_ZOO_01.11.19.546-01.11.20.987', '3091_ZOMBIELAND_01.18.59.762-01.19.03.333', '3091_ZOMBIELAND_01.06.24.582-01.06.27.220', '0005_Chinatown_00.47.37.823-00.47.38.678', '3063_SOUL_SURFER_01.19.35.611-01.19.37.873']:
                    caption_dict[len(caption_dict)] = (clip_id, (sentence, None, None))
                    if clip_id not in video_id_list: video_id_list.append(clip_id)

        video_dict = OrderedDict()
        sentences_dict = OrderedDict()

        for root, dub_dir, video_files in os.walk(self.video_path):
            for video_file in video_files:
                video_id_ = ".".join(video_file.split(".")[:-1])
                if video_id_ not in video_id_list:
                    continue
                file_path_ = os.path.join(root, video_file)
                video_dict[video_id_] = file_path_

        # Get all captions
        for clip_id, sentence in caption_dict.values():
            if clip_id not in video_dict:
                continue
            sentences_dict[len(sentences_dict)] = (clip_id, sentence)

        unique_sentence = set([v[1][0] for v in sentences_dict.values()])
        print('[{}] Unique sentence is {} , all num is {}'.format(subset, len(unique_sentence), len(sentences_dict)))

        return video_dict, sentences_dict